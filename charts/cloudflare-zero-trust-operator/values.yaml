# Override the chart name used in resource names and labels.
nameOverride: ""
# Override the fully qualified app name used in resource names.
fullnameOverride: ""

# -------------------------------------------------------------------
# Image settings
# -------------------------------------------------------------------
image:
  registry: ghcr.io
  repository: wheetazlab/cloudflare-zero-trust-operator
  # tag defaults to the chart's appVersion when left empty
  tag: ""
  pullPolicy: Always

imagePullSecrets: []

# -------------------------------------------------------------------
# Namespace
# -------------------------------------------------------------------
# The namespace in which the operator is installed.
# If createNamespace is true the chart will create it.
namespaceOverride: ""
createNamespace: true

# -------------------------------------------------------------------
# Operator runtime switches
# These become environment variables in the operator container.
# -------------------------------------------------------------------
operator:
  # Comma-separated list of namespaces to watch for HTTPRoutes.
  # Leave empty to watch ALL namespaces (cluster-wide).
  watchNamespaces: ""

  # How often (in seconds) the operator polls Cloudflare and reconciles.
  pollIntervalSeconds: 60

  # Log verbosity: DEBUG | INFO | WARNING | ERROR
  logLevel: INFO

  # Cloudflare REST API base URL – override only if using a proxy/mock.
  cloudflareApiBase: "https://api.cloudflare.com/client/v4"

  # Any extra environment variables to inject into the operator container.
  # Useful for proxy settings, tracing endpoints, etc.
  # extraEnv:
  #   - name: HTTP_PROXY
  #     value: "http://proxy.example.com:3128"
  extraEnv: []

# -------------------------------------------------------------------
# Replica count
# The CloudflareZeroTrustOperatorConfig CRD can also control this
# at runtime without a Helm upgrade.
# -------------------------------------------------------------------
replicaCount: 1

# -------------------------------------------------------------------
# Resource requests / limits
# -------------------------------------------------------------------
resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

# -------------------------------------------------------------------
# ServiceAccount
# -------------------------------------------------------------------
serviceAccount:
  # Set to false to bring your own ServiceAccount.
  create: true
  # Override the generated name (defaults to the full chart name).
  name: ""
  annotations: {}

# -------------------------------------------------------------------
# Pod scheduling
# -------------------------------------------------------------------
nodeSelector: {}

tolerations: []

affinity: {}

priorityClassName: ""

# -------------------------------------------------------------------
# Pod / container metadata
# -------------------------------------------------------------------
podAnnotations: {}
podLabels: {}

# -------------------------------------------------------------------
# Security contexts
# These match the hardened defaults shipped in config/deployment/.
# -------------------------------------------------------------------
podSecurityContext:
  fsGroup: 1000
  runAsNonRoot: true
  seccompProfile:
    type: RuntimeDefault

securityContext:
  allowPrivilegeEscalation: false
  runAsNonRoot: true
  runAsUser: 1000
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: true

# -------------------------------------------------------------------
# RBAC
# Set to false if you are managing RBAC outside of this chart.
# -------------------------------------------------------------------
rbac:
  create: true

# -------------------------------------------------------------------
# Tenant bootstrap (optional, disabled by default)
#
# When tenant.create=true, Helm will render a CloudflareZeroTrustTenant
# CR and (if apiToken is set) the accompanying API-token Secret.
#
# ALL fields marked "Required when create=true" MUST be supplied —
# the chart will fail at render time if any are missing.
# -------------------------------------------------------------------
# Set to false to skip deploying the example CloudflareZeroTrustTemplate CRs into the
# operator namespace. Templates are installed by default as a starter set.
# They are labelled cfzt.cloudflare.com/example: "true" for easy cleanup:
#   kubectl delete cfzttemplate -l cfzt.cloudflare.com/example=true
exampleTemplates:
  install: false

# -------------------------------------------------------------------
tenant:
  # Set to true to create the Tenant CR and API token Secret.
  # Nothing is rendered when this is false.
  create: false

  # (Required when create=true) Instance name for the CloudflareZeroTrustTenant CR
  # (becomes metadata.name). There is intentionally no default — you must choose
  # a meaningful label, e.g. "home", "prod", "wheetazlab".
  instanceName: ""

  # Namespace in which the Tenant CR and Secret are created.
  # Defaults to the operator's release namespace when left empty.
  namespace: ""

  # (Required when create=true) Your Cloudflare Account ID (32-char hex).
  accountId: ""

  # (Required when create=true) Your Cloudflare Tunnel ID (UUID).
  tunnelId: ""

  # (Optional) Cloudflare Zone ID (32-char hex).
  # The operator auto-discovers the zone ID from each hostname via the Cloudflare
  # Zones API (Zone:Read permission required). If you set zoneId here, the
  # discovered ID is validated against it and the reconcile fails on a mismatch
  # — useful as a safety check or when Zone:Read is not available on the token.
  #   - Tunnel mode:   CNAME created automatically when zone is resolved
  #   - dns-only mode: A record created; zone resolution is required
  zoneId: ""

  # Cloudflare API token — provide EXACTLY ONE of the two options below.
  # Helm will fail at render time if neither is provided.
  #
  # Option A: Inline plaintext token (stored in a new Secret).
  #   Required permissions: Account → Cloudflare Tunnel: Edit,
  #                         Account → Access: Edit
  apiToken: ""

  # Option B: Reference a pre-existing Secret already in the cluster.
  #   Ignored when apiToken is set.
  existingSecret:
    name: ""
    key: "token"

