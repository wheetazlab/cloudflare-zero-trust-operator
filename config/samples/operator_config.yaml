---
# Example CloudflareZeroTrustOperatorConfig
# This configures the operator pod's scheduling, resources, and behavior
# NOTE: This is a singleton - only one should exist in the operator namespace

apiVersion: cfzt.cloudflare.com/v1alpha1
kind: CloudflareZeroTrustOperatorConfig
metadata:
  name: operator-config
  namespace: cloudflare-zero-trust
  labels:
    app: cloudflare-zero-trust-operator
spec:
  # Number of operator pod replicas
  # Generally keep at 1 to avoid race conditions during reconciliation
  replicas: 1

  # Resource requests and limits
  resources:
    requests:
      cpu: "100m"
      memory: "256Mi"
    limits:
      cpu: "500m"
      memory: "512Mi"

  # Environment variable configuration
  environmentVariables:
    # Reconciliation interval in seconds
    pollIntervalSeconds: 60
    
    # Global log level (can be overridden per-tenant in CloudflareZeroTrustTenant CR)
    logLevel: "INFO"
    
    # Namespaces to watch (comma-separated, empty = all namespaces)
    watchNamespaces: ""

  # Image pull policy
  imagePullPolicy: "Always"

  # Node selector for pod placement
  # Example: Schedule operator on nodes with specific labels
  # nodeSelector:
  #   node-role.kubernetes.io/worker: ""
  #   zone: us-west-2a

  # Pod affinity/anti-affinity rules
  # Example: Prefer nodes in zone us-west-2a
  # affinity:
  #   nodeAffinity:
  #     preferredDuringSchedulingIgnoredDuringExecution:
  #       - weight: 100
  #         preference:
  #           matchExpressions:
  #             - key: topology.kubernetes.io/zone
  #               operator: In
  #               values:
  #                 - us-west-2a

  # Tolerations for node taints
  # Example: Allow scheduling on nodes with specific taints
  # tolerations:
  #   - key: "dedicated"
  #     operator: "Equal"
  #     value: "operators"
  #     effect: "NoSchedule"

  # Priority class for pod scheduling priority
  # Requires PriorityClass to exist in cluster
  # priorityClassName: "high-priority"

  # Additional labels for operator pod
  # podLabels:
  #   team: "platform"
  #   cost-center: "engineering"

  # Additional annotations for operator pod
  # podAnnotations:
  #   prometheus.io/scrape: "true"
  #   prometheus.io/port: "8080"
