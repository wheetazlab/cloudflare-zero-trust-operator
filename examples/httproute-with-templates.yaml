---
# Example 1: Using default template (public route)
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: public-app
  namespace: default
  annotations:
    # Enable operator management
    cfzt.cloudflare.com/enabled: "true"
    
    # Public hostname to configure
    cfzt.cloudflare.com/hostname: "app.example.com"
    
    # Optional: Specify tenant (uses only tenant in namespace if omitted)
    cfzt.cloudflare.com/tenant: "prod-tenant"
    
    # Optional: Specify template (uses 'default' template if omitted)
    # cfzt.cloudflare.com/template: "default"
spec:
  parentRefs:
    - name: default
      namespace: default
  hostnames:
    - "app.example.com"
  rules:
    - backendRefs:
        - name: public-app
          port: 80

---
# Example 2: Secure internal app with Azure AD authentication
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: longhorn
  namespace: default
  annotations:
    cfzt.cloudflare.com/enabled: "true"
    cfzt.cloudflare.com/hostname: "longhorn.wheethome.com"
    cfzt.cloudflare.com/tenant: "prod-tenant"
    
    # Use template with Access Application and existing Azure AD policy
    cfzt.cloudflare.com/template: "secure-internal-app"
spec:
  parentRefs:
    - name: default
      namespace: default
  hostnames:
    - "longhorn.wheethome.com"
  rules:
    - backendRefs:
        - name: longhorn-frontend
          namespace: longhorn-system
          port: 80

---
# Example 3: gRPC backend service
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: grpc-api
  namespace: grpc-namespace
  annotations:
    cfzt.cloudflare.com/enabled: "true"
    cfzt.cloudflare.com/hostname: "grpc.example.com"
    cfzt.cloudflare.com/template: "grpc-backend"
spec:
  parentRefs:
    - name: default
      namespace: default
  hostnames:
    - "grpc.example.com"
  rules:
    - backendRefs:
        - name: grpc-service
          port: 443

---
# Example 4: Public API with service token
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: api-backend
  namespace: api-namespace
  annotations:
    cfzt.cloudflare.com/enabled: "true"
    cfzt.cloudflare.com/hostname: "api.example.com"
    cfzt.cloudflare.com/template: "api-with-service-token"
spec:
  parentRefs:
    - name: default
      namespace: default
  hostnames:
    - "api.example.com"
  rules:
    - backendRefs:
        - name: api-backend
          port: 8000

---
# Example 5: Admin panel with strict security
apiVersion: gateway.networking.k8s.io/v1
kind: HTTPRoute
metadata:
  name: admin-panel
  namespace: admin-namespace
  annotations:
    cfzt.cloudflare.com/enabled: "true"
    cfzt.cloudflare.com/hostname: "admin.example.com"
    cfzt.cloudflare.com/template: "admin-panel"
spec:
  parentRefs:
    - name: default
      namespace: default
  hostnames:
    - "admin.example.com"
  rules:
    - backendRefs:
        - name: admin-panel
          port: 3000
