---
# Example 1: Using default template (public route)
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: public-app
  namespace: default
  annotations:
    # Enable operator management
    cfzt.cloudflare.com/enabled: "true"
    
    # Public hostname to configure
    cfzt.cloudflare.com/hostname: "app.example.com"
    
    # Optional: Specify tenant (uses only tenant in namespace if omitted)
    cfzt.cloudflare.com/tenant: "prod-tenant"
    
    # Optional: Specify template (uses 'default' template if omitted)
    # cfzt.cloudflare.com/template: "default"
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`app.example.com`)
      kind: Rule
      services:
        - name: public-app
          port: 80
  tls:
    secretName: app-tls

---
# Example 2: Secure internal app with Azure AD authentication
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: longhorn
  namespace: default
  annotations:
    cfzt.cloudflare.com/enabled: "true"
    cfzt.cloudflare.com/hostname: "longhorn.wheethome.com"
    cfzt.cloudflare.com/tenant: "prod-tenant"
    
    # Use template with Access Application and existing Azure AD policy
    cfzt.cloudflare.com/template: "secure-internal-app"
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`longhorn.wheethome.com`)
      kind: Rule
      services:
        - name: longhorn-frontend
          namespace: longhorn-system
          port: 80
  tls:
    secretName: longhorn-tls

---
# Example 3: gRPC backend service
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: grpc-api
  namespace: grpc-namespace
  annotations:
    cfzt.cloudflare.com/enabled: "true"
    cfzt.cloudflare.com/hostname: "grpc.example.com"
    cfzt.cloudflare.com/template: "grpc-backend"
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`grpc.example.com`)
      kind: Rule
      services:
        - name: grpc-service
          port: 443
  tls:
    secretName: grpc-tls

---
# Example 4: Public API with service token
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: api-backend
  namespace: api-namespace
  annotations:
    cfzt.cloudflare.com/enabled: "true"
    cfzt.cloudflare.com/hostname: "api.example.com"
    cfzt.cloudflare.com/template: "api-with-service-token"
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`api.example.com`)
      kind: Rule
      services:
        - name: api-backend
          port: 8000
  tls:
    secretName: api-tls

---
# Example 5: Admin panel with strict security
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: admin-panel
  namespace: admin-namespace
  annotations:
    cfzt.cloudflare.com/enabled: "true"
    cfzt.cloudflare.com/hostname: "admin.example.com"
    cfzt.cloudflare.com/template: "admin-panel"
spec:
  entryPoints:
    - websecure
  routes:
    - match: Host(`admin.example.com`)
      kind: Rule
      services:
        - name: admin-panel
          port: 3000
  tls:
    secretName: admin-tls
